<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Babushka</title>
  <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
      <link rel="stylesheet" type="text/css" href="../../css/global.css"></link>
      <script type="text/javascript" src="../../js/common.js"></script>
</head>
<body>
    <div id="header"><a class="header" href="../../index.html">[]|\|[-/-\|_/\/\[]|\||)</a></div>
    <div id="content" class="content" style="width:70%;height:auto">
<header id="title-block-header">
<h1 class="title">Babushka</h1>
</header>
<p>In script <code>babushka.py</code>, there are 250 functions with random generated names, half of them are not called. To seperate them we generate a list of all the random generated names in file <code>func_names</code>, scan again to find thoses actually contribute to the final result, we only pay attention to those function listed in file <code>valid_funcs</code>.</p>
<pre><code>for f in `cat func_names`;do c=$(grep $f babushka.py |wc -l);if [ $c -gt 1 ];then echo $f:$c;fi;done &gt; valid_funcs</code></pre>
<p><code>check_key</code> takes input string as key and pads it to reach length of <code>128</code>, return a list of boolean value, <code>combiner</code> takes the list as parameter, return true if particular positions in the list is <code>True</code>.</p>
<p>Run <code>combiner</code> only with key <code>UMASS</code>, we get a list of 23 <code>False</code> from <code>check_key</code>.</p>
<pre><code>    key = input(&quot;Oi, babushka, what&#39;s the key? &quot;)
    combiner = types.FunctionType(types.CodeType(*pickle.loads(b&#39;\x80\x04\x95\xcc\x00\x00\x00\x00\x00\x00\x00]\x94(K\x01K\x00K\x00K\x04K\x03KCC@d\x01}\x01|\x00D\x00]\x0c}\x02|\x01o\x12|\x02}\x01q\x08d\x02}\x03|\x00D\x00]\x0c}\x02|\x03|\x02O\x00}\x03q\x1e|\x01s4|\x03r8d\x02p&gt;|\x00d\x03\x19\x00S\x00\x94(N\x88\x89K\x00t\x94)(\x8c\nOUVCHXMRZO\x94\x8c\nGDOZHYKENT\x94\x8c\nTZCLOUEGVM\x94\x8c\nMMBJDKSFLR\x94t\x94\x8c\x0e&lt;OwOwhatsthis&gt;\x94\x8c\x0cany_combiner\x94J\xa2\xee\x81\x02C\x0e\x00\x01\x04\x01\x08\x01\n\x01\x04\x01\x08\x01\n\x01\x94))e.&#39;)), globals())

    res = check_key(key)
    print(res)</code></pre>
<p>Create a list of 23 <code>True</code>, change one position to <code>False</code> every time. As long as <code>res[0]</code> is <code>True</code>, the result is <code>Yes!</code>.</p>
<pre><code>    res = [True] * 23
    for i in range(len(res)):
        res[i] = False
        if combiner(res):
            print(&quot;Yes!&quot;)
        else:
            print(&quot;No!&quot;)
        res[i] = True</code></pre>
<pre><code>python3 babushka.py &lt;&lt;&lt; UMASS
Oi, babushka, what&#39;s the key? No!
Yes!
Yes!
Yes!
Yes!
Yes!
Yes!
Yes!
Yes!
Yes!
Yes!
Yes!
Yes!
Yes!
Yes!
Yes!
Yes!
Yes!
Yes!
Yes!
Yes!
Yes!
Yes!</code></pre>
<p>Insert debug code <code>print(inspect.stack()[0].function, b)</code> into each function before return, we are able to observe how return of each function affect the final result. Play around with different conditions, it seems if the <code>14th</code> place of list returned by <code>DSIIPABGWUFNMMMZAGWI</code> function is <code>True</code>, the result is <code>Yes!</code>.</p>
<pre><code>BHXFVDRTGGNFTXBCOMOJ [False, False, False, False]
BFUQBRFEKUSFTVYAIUBC [False, False, False, False, False, False, False, False]                                                                                       LXNQKJIZEUZPFAQFDWIY [False, False, False, False, False, False, False, False, False, False, False, False]
DSIIPABGWUFNMMMZAGWI [False, False, False, False, False, False, False, False, False, False, False, False, False, True, False, False]
GXMDJYHXMQHQTWTTLDEF [False, False, False, False, False, False, False, False, False, False, False, False, False, True, False, False, False, False, False, False]
AVMDIBYGKPJHLWZSFMZK [False, False, False, False, False, False, False, False, False, False, False, False, False, True, False, False, False, False, False, False, False, False, False, False]                                                                                                                                            
QHNSNERTVUQZQIOVLXHU [True, False, False, False]
...
check_key: [True, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, True]
Yes!</code></pre>
<p>The 14th value is controlled by bytecode in function <code>DSIIPABGWUFNMMMZAGWI</code>. Disassemble bytecode (<code>code0</code>) in function <code>DSIIPABGWUFNMMMZAGWI</code> with Python module <code>dis</code>, we get another piece of bytecode(<code>code1</code>), disassemble <code>code1</code> we get bytecodes (<code>code2</code>) without any further call to randomly named function. Every return appends a <code>True</code> or <code>False</code> to the list, so return of <code>code1</code> might give us what we what.</p>
<pre><code>import types,pickle,dis
code = types.CodeType(*pickle.loads(b&#39;\x80\x04\x95\x11\x13\x00\x00\x00\x00\x00\x00]\x94(K\x01K\x00K...\x01\x14\x01\x16\x018\x01\x06\x01\x1a\x01\x0c\x01\x94))e.&#39;))
dis.disco(code)</code></pre>
<p>Now take a look into the dissambled <code>code1</code>, to make it return <code>True</code> we need to make the key meet all the requirements here.</p>
<pre><code>42069667           0 LOAD_CONST               1 (True)
                   2 STORE_FAST               1 (OVXPEYYWSK)

42069668           4 LOAD_FAST                1 (OVXPEYYWSK)
                   6 JUMP_IF_FALSE_OR_POP   198
                   8 LOAD_GLOBAL              0 (ord)
                  10 LOAD_FAST                0 (QFBKDVBLQX)
                  12 LOAD_CONST               2 (12)
                  14 BINARY_SUBSCR
                  16 CALL_FUNCTION            1
                  18 LOAD_CONST               3 (128)
                  20 BINARY_AND
                  22 LOAD_CONST               4 (7)
                  24 BINARY_RSHIFT
                  26 LOAD_CONST               5 (0)
                  28 COMPARE_OP               2 (==)
                  30 JUMP_IF_FALSE_OR_POP   198
                  32 LOAD_GLOBAL              0 (ord)
                  34 LOAD_FAST                0 (QFBKDVBLQX)
                  36 LOAD_CONST               2 (12)
                  38 BINARY_SUBSCR
                  40 CALL_FUNCTION            1
                  42 LOAD_CONST               6 (64)
                  44 BINARY_AND
                  46 LOAD_CONST               7 (6)
                  48 BINARY_RSHIFT
                  50 LOAD_CONST               8 (1)
                  52 COMPARE_OP               2 (==)
                  54 JUMP_IF_FALSE_OR_POP   198
                  56 LOAD_GLOBAL              0 (ord)
                  58 LOAD_FAST                0 (QFBKDVBLQX)
                  60 LOAD_CONST               2 (12)
                  62 BINARY_SUBSCR
                  64 CALL_FUNCTION            1
                  66 LOAD_CONST               9 (32)
                  68 BINARY_AND
                  70 LOAD_CONST              10 (5)
                  72 BINARY_RSHIFT
                  74 LOAD_CONST               8 (1)
                  76 COMPARE_OP               2 (==)
                  78 JUMP_IF_FALSE_OR_POP   198
                  80 LOAD_GLOBAL              0 (ord)
                  82 LOAD_FAST                0 (QFBKDVBLQX)
                  84 LOAD_CONST               2 (12)
                  86 BINARY_SUBSCR
                  88 CALL_FUNCTION            1
                  90 LOAD_CONST              11 (16)
                  92 BINARY_AND
                  94 LOAD_CONST              12 (4)
                  96 BINARY_RSHIFT
                  98 LOAD_CONST               5 (0)
                 100 COMPARE_OP               2 (==)
                 102 JUMP_IF_FALSE_OR_POP   198
                 104 LOAD_GLOBAL              0 (ord)
                 106 LOAD_FAST                0 (QFBKDVBLQX)
                 108 LOAD_CONST               2 (12)
                 110 BINARY_SUBSCR
                 112 CALL_FUNCTION            1
                 114 LOAD_CONST              13 (8)
                 116 BINARY_AND
                 118 LOAD_CONST              14 (3)
                 120 BINARY_RSHIFT
                 122 LOAD_CONST               8 (1)
                 124 COMPARE_OP               2 (==)
                 126 JUMP_IF_FALSE_OR_POP   198
                 128 LOAD_GLOBAL              0 (ord)
                 130 LOAD_FAST                0 (QFBKDVBLQX)
                 132 LOAD_CONST               2 (12)
                 134 BINARY_SUBSCR
                 136 CALL_FUNCTION            1
                 138 LOAD_CONST              12 (4)
                 140 BINARY_AND
                 142 LOAD_CONST              15 (2)
                 144 BINARY_RSHIFT
                 146 LOAD_CONST               5 (0)
                 148 COMPARE_OP               2 (==)
                 150 JUMP_IF_FALSE_OR_POP   198
                 152 LOAD_GLOBAL              0 (ord)
                 154 LOAD_FAST                0 (QFBKDVBLQX)
                 156 LOAD_CONST               2 (12)
                 158 BINARY_SUBSCR
                 160 CALL_FUNCTION            1
                 162 LOAD_CONST              15 (2)
                 164 BINARY_AND
                 166 LOAD_CONST               8 (1)
                 168 BINARY_RSHIFT
                 170 LOAD_CONST               5 (0)
                 172 COMPARE_OP               2 (==)
                 174 JUMP_IF_FALSE_OR_POP   198
                 176 LOAD_GLOBAL              0 (ord)
                 178 LOAD_FAST                0 (QFBKDVBLQX)
                 180 LOAD_CONST               2 (12)
                 182 BINARY_SUBSCR
                 184 CALL_FUNCTION            1
                 186 LOAD_CONST               8 (1)
                 188 BINARY_AND
                 190 LOAD_CONST               5 (0)
                 192 BINARY_RSHIFT
                 194 LOAD_CONST               8 (1)
                 196 COMPARE_OP               2 (==)
                 ...

                3976 LOAD_GLOBAL              0 (ord)
                3978 LOAD_FAST                0 (QFBKDVBLQX)
                3980 LOAD_CONST               7 (6)
                3982 BINARY_SUBSCR
                3984 CALL_FUNCTION            1
                3986 LOAD_CONST              19 (15)
                3988 BINARY_AND
                3990 LOAD_CONST              12 (4)
                3992 BINARY_XOR
                3994 LOAD_CONST               5 (0)
                3996 COMPARE_OP               2 (==)
             &gt;&gt; 3998 STORE_FAST               1 (OVXPEYYWSK)

42069715        4000 LOAD_FAST                1 (OVXPEYYWSK)
                4002 EXTENDED_ARG            15
                4004 JUMP_IF_FALSE_OR_POP  4020
                4006 LOAD_GLOBAL              0 (ord)
                4008 LOAD_FAST                0 (QFBKDVBLQX)
                4010 LOAD_CONST              61 (27)
                4012 BINARY_SUBSCR
                4014 CALL_FUNCTION            1
                4016 LOAD_CONST              51 (95)
                4018 COMPARE_OP               2 (==)
             &gt;&gt; 4020 STORE_FAST               1 (OVXPEYYWSK)

42069716        4022 LOAD_FAST                1 (OVXPEYYWSK)
                4024 BUILD_LIST               1
                4026 STORE_FAST               1 (OVXPEYYWSK)

42069717        4028 LOAD_GLOBAL              2 (types)
                4030 LOAD_METHOD              3 (FunctionType)
                4032 LOAD_GLOBAL              2 (types)
                4034 LOAD_ATTR                4 (CodeType)
                4036 LOAD_GLOBAL              5 (pickle)
                4038 LOAD_METHOD              6 (loads)
                4040 LOAD_CONST              62 (b&#39;\x80\x04\x95\x11\x13\x00\x00\x00\x00\x00\x00]\x94(K\x01K\x00K\x00K\x04K\x04KCBL\x11\x00\x00d\x01}\x01|\x01o\xc6t\x00|\x00d\x02\x19\x00\x83\x01d\x03@\x00d\x04?\x00d\x05k\x02o\xc6t\x00|\x00d\x02\x19\x00\x83\x01d\x06@\x00d\x07?\x00d\x08k\x02o\xc6t\x00|\x00d\x02\x19\x00\x83\x01d\t@\x00d\n?\x00d\x05k\x02o\xc6t\x00|\x00d\x02\x19\x00\x83\x01d\x0b@\x00d\x02?\x00d\x08k\x02o\xc6t\x00|\x00d\x02\x19\x00\x83\x01d\x0c@\x00d\r?\x00d\x05k\x02o\xc6t\x00|\x00d\x02\x19\x00\x83\x01d\x02@\x00d\x0e?\x00d\x05k\x02o\xc6t\x00|\x00d\x02\x19\x00\x83\x01d\x0e@\x00d\x08?\x00d\x08k\x02o\xc6t\x00|\x00d\x02\x19\x00\x83\x01d\x08@\x00d\x05?\x00d\x08k\x02}\x01|\x01o\xfat\x00|\x00d\x0f\x19\x00\x83\x01d\x10@\x00d\x11A\x00d\x05k\x02o\xfat\x00|\x00d\x0f\x19\x00\x83\x01d\x12@\x00d\x0eA\x00d\x05k\x02}\x01|\x01\x90\x01o\x10t\x00|\x00d\x13\x19\x00\x83\x01d\x14k\x02}\x01|\x01\x90\x01o\xe4t\x00|\x00d\x15\x19\x00\x83\x01d\x03@\x00d\x04?\x00d\x05k\x02\x90\x01o\xe4t\x00|\x00d\x15\x19\x00\x83\x01d\x06@\x00d\x07?\x00d\x08k\x02\x90\x01o\xe4t\x00|\x00d\x15\x19\x00\x83\x01d\t@\x00d\n?\x00d\x08k\x02\x90\x01o\xe4t\x00|\x00d\x15\x19\x00\x83\x01d\x0b@\x00d\x02?\x00d\x05k\x02\x90\x01o\xe4t\x00|\x00d\x15\x19\x00\x83\x01d\x0c@\x00d\r?\x00d\x08k\x02\x90\x01o\xe4t\x00|\x00d\x15\x19\x00\x83\x01d\x02@\x00d\x0e?\x00d\x08k\x02\x90\x01o\xe4t\x00|\x00d\x15\x19\x00\x83\x01d\x0e@\x00d\x08?\x00d\x05k\x02\x90\x01o\xe4t\x00|\x00d\x15\x19\x00\x83\x01d\x08@\x00d\x05?\x00d\x08k\x02}\x01|\x01\x90\x01o\xfat\x00|\x00d\x16\x19\x00\x83\x01d\x17k\x02}\x01|\x01\x90\x02o\xcet\x00|\x00d\t\x19\x00\x83\x01d\x03@\x00d\x04?\x00d\x05k\x02\x90\x02o\xcet\x00|\x00d\t\x19\x00\x83\x01d\x06@\x00d\x07?\x00d\x08k\x02\x90\x02o\xcet\x00|\x00d\t\x19\x00\x83\x01d\t@\x00d\n?\x00d\x05k\x02\x90\x02o\xcet\x00|\x00d\t\x19\x00\x83\x01d\x0b@\x00d\x02?\x00d\x08k\x02\x90\x02o\xcet\x00|\x00d\t\x19\x00\x83\x01d\x0c@\x00d\r?\x00d\x08k\x02\x90\x02o\xcet\x00|\x00d\t\x19\x00\x83\x01d\x02@\x00d\x0e?\x00d\x08k\x02\x90\x02o\xcet\x00|\x00d\t\x19\x00\x83\x01d\x0e@\x00d\x08?\x00d\x08k\x02\x90\x02o\xcet\x00|\x00d\t\x19\x00\x83\x01d\x08@\x00d\x05?\x00d\x08k\x02}\x01|\x01\x90\x03o\xa2t\x00|\x00d\x18\x19\x00\x83\x01d\x03@\x00d\x04?\x00d\x05k\x02\x90\x03o\xa2t\x00|\x00d\x18\x19\x00\x83\x01d\x06@\x00d\x07?\x00d\x08k\x02\x90\x03o\xa2t\x00|\x00d\x18\x19\x00\x83\x01d\t@\x00d\n?\x00d\x08k\x02\x90\x03o\xa2t\x00|\x00d\x18\x19\x00\x83\x01d\x0b@\x00d\x02?\x00d\x05k\x02\x90\x03o\xa2t\x00|\x00d\x18\x19\x00\x83\x01d\x0c@\x00d\r?\x00d\x08k\x02\x90\x03o\xa2t\x00|\x00d\x18\x19\x00\x83\x01d\x02@\x00d\x0e?\x00d\x08k\x02\x90\x03o\xa2t\x00|\x00d\x18\x19\x00\x83\x01d\x0e@\x00d\x08?\x00d\x08k\x02\x90\x03o\xa2t\x00|\x00d\x18\x19\x00\x83\x01d\x08@\x00d\x05?\x00d\x05k\x02}\x01|\x01\x90\x03o\xb8t\x00|\x00d\x0c\x19\x00\x83\x01d\x19k\x02}\x01|\x01\x90\x03o\xf0t\x00|\x00d\x1a\x19\x00\x83\x01d\x10@\x00d\x11A\x00d\x05k\x02\x90\x03o\xf0t\x00|\x00d\x1a\x19\x00\x83\x01d\x12@\x00d\x1bA\x00d\x05k\x02}\x01|\x01\x90\x04o\xc4t\x00|\x00d\x1c\x19\x00\x83\x01d\x03@\x00d\x04?\x00d\x05k\x02\x90\x04o\xc4t\x00|\x00d\x1c\x19\x00\x83\x01d\x06@\x00d\x07?\x00d\x08k\x02\x90\x04o\xc4t\x00|\x00d\x1c\x19\x00\x83\x01d\t@\x00d\n?\x00d\x08k\x02\x90\x04o\xc4t\x00|\x00d\x1c\x19\x00\x83\x01d\x0b@\x00d\x02?\x00d\x08k\x02\x90\x04o\xc4t\x00|\x00d\x1c\x19\x00\x83\x01d\x0c@\x00d\r?\x00d\x05k\x02\x90\x04o\xc4t\x00|\x00d\x1c\x19\x00\x83\x01d\x02@\x00d\x0e?\x00d\x08k\x02\x90\x04o\xc4t\x00|\x00d\x1c\x19\x00\x83\x01d\x0e@\x00d\x08?\x00d\x05k\x02\x90\x04o\xc4t\x00|\x00d\x1c\x19\x00\x83\x01d\x08@\x00d\x05?\x00d\x05k\x02}\x01|\x00d\x00d\n\x85\x02\x19\x00d\x1dk\x03\x90\x04r\xded\x1eg\x01S\x00|\x01\x90\x04o\xf2t\x00|\x00d\x1f\x19\x00\x83\x01d k\x02}\x01|\x01\x90\x05o\xc6t\x00|\x00d!\x19\x00\x83\x01d\x03@\x00d\x04?\x00d\x05k\x02\x90\x05o\xc6t\x00|\x00d!\x19\x00\x83\x01d\x06@\x00d\x07?\x00d\x05k\x02\x90\x05o\xc6t\x00|\x00d!\x19\x00\x83\x01d\t@\x00d\n?\x00d\x08k\x02\x90\x05o\xc6t\x00|\x00d!\x19\x00\x83\x01d\x0b@\x00d\x02?\x00d\x08k\x02\x90\x05o\xc6t\x00|\x00d!\x19\x00\x83\x01d\x0c@\x00d\r?\x00d\x05k\x02\x90\x05o\xc6t\x00|\x00d!\x19\x00\x83\x01d\x02@\x00d\x0e?\x00d\x05k\x02\x90\x05o\xc6t\x00|\x00d!\x19\x00\x83\x01d\x0e@\x00d\x08?\x00d\x05k\x02\x90\x05o\xc6t\x00|\x00d!\x19\x00\x83\x01d\x08@\x00d\x05?\x00d\x05k\x02}\x01|\x01\x90\x05o\xdct\x00|\x00d\x0e\x19\x00\x83\x01d&quot;k\x02}\x01|\x01\x90\x06o\xb0t\x00|\x00d#\x19\x00\x83\x01d\x03@\x00d\x04?\x00d\x05k\x02\x90\x06o\xb0t\x00|\x00d#\x19\x00\x83\x01d\x06@\x00d\x07?\x00d\x08k\x02\x90\x06o\xb0t\x00|\x00d#\x19\x00\x83\x01d\t@\x00d\n?\x00d\x08k\x02\x90\x06o\xb0t\x00|\x00d#\x19\x00\x83\x01d\x0b@\x00d\x02?\x00d\x05k\x02\x90\x06o\xb0t\x00|\x00d#\x19\x00\x83\x01d\x0c@\x00d\r?\x00d\x05k\x02\x90\x06o\xb0t\x00|\x00d#\x19\x00\x83\x01d\x02@\x00d\x0e?\x00d\x08k\x02\x90\x06o\xb0t\x00|\x00d#\x19\x00\x83\x01d\x0e@\x00d\x08?\x00d\x08k\x02\x90\x06o\xb0t\x00|\x00d#\x19\x00\x83\x01d\x08@\x00d\x05?\x00d\x05k\x02}\x01|\x01\x90\x06o\xe8t\x00|\x00d$\x19\x00\x83\x01d\x10@\x00d\x11A\x00d\x05k\x02\x90\x06o\xe8t\x00|\x00d$\x19\x00\x83\x01d\x12@\x00d\x08A\x00d\x05k\x02}\x01|\x01\x90\x06o\xfet\x00|\x00d%\x19\x00\x83\x01d&amp;k\x02}\x01t\x00|\x00d\x05\x19\x00\x83\x01d\x10@\x00d\&#39;k\x02\x90\x07r\x1cd(}\x02n\x04d)}\x02|\x01\x90\x07o4t\x00|\x00d*\x19\x00\x83\x01d+k\x02}\x01|\x01\x90\x07olt\x00|\x00d,\x19\x00\x83\x01d\x10@\x00d-A\x00d\x05k\x02\x90\x07olt\x00|\x00d,\x19\x00\x83\x01d\x12@\x00d\x02A\x00d\x05k\x02}\x01|\x01\x90\x07o\x82t\x00|\x00d.\x19\x00\x83\x01d/k\x02}\x01|\x01\x90\x08oVt\x00|\x00d\x08\x19\x00\x83\x01d\x03@\x00d\x04?\x00d\x05k\x02\x90\x08oVt\x00|\x00d\x08\x19\x00\x83\x01d\x06@\x00d\x07?\x00d\x08k\x02\x90\x08oVt\x00|\x00d\x08\x19\x00\x83\x01d\t@\x00d\n?\x00d\x05k\x02\x90\x08oVt\x00|\x00d\x08\x19\x00\x83\x01d\x0b@\x00d\x02?\x00d\x05k\x02\x90\x08oVt\x00|\x00d\x08\x19\x00\x83\x01d\x0c@\x00d\r?\x00d\x08k\x02\x90\x08oVt\x00|\x00d\x08\x19\x00\x83\x01d\x02@\x00d\x0e?\x00d\x08k\x02\x90\x08oVt\x00|\x00d\x08\x19\x00\x83\x01d\x0e@\x00d\x08?\x00d\x05k\x02\x90\x08oVt\x00|\x00d\x08\x19\x00\x83\x01d\x08@\x00d\x05?\x00d\x08k\x02}\x01|\x01\x90\to*t\x00|\x00d\x1b\x19\x00\x83\x01d\x03@\x00d\x04?\x00d\x05k\x02\x90\to*t\x00|\x00d\x1b\x19\x00\x83\x01d\x06@\x00d\x07?\x00d\x08k\x02\x90\to*t\x00|\x00d\x1b\x19\x00\x83\x01d\t@\x00d\n?\x00d\x05k\x02\x90\to*t\x00|\x00d\x1b\x19\x00\x83\x01d\x0b@\x00d\x02?\x00d\x08k\x02\x90\to*t\x00|\x00d\x1b\x19\x00\x83\x01d\x0c@\x00d\r?\x00d\x08k\x02\x90\to*t\x00|\x00d\x1b\x19\x00\x83\x01d\x02@\x00d\x0e?\x00d\x08k\x02\x90\to*t\x00|\x00d\x1b\x19\x00\x83\x01d\x0e@\x00d\x08?\x00d\x08k\x02\x90\to*t\x00|\x00d\x1b\x19\x00\x83\x01d\x08@\x00d\x05?\x00d\x08k\x02}\x01t\x00d0\x83\x01t\x00|\x00d\x05\x19\x00\x83\x01A\x00}\x03|\x01\x90\toTt\x00|\x00d\x05\x19\x00\x83\x01d1k\x02}\x01|\x00d\x00d\n\x85\x02\x19\x00d\x1dk\x03\x90\trnd\x1eg\x01S\x00|\x01\x90\to\x82t\x00|\x00d2\x19\x00\x83\x01d\x17k\x02}\x01t\x00|\x00d\x05\x19\x00\x83\x01d\x10@\x00d2k\x02\x90\tr\xa0d3}\x02n\x04d4}\x02|\x01\x90\to\xdat\x00|\x00d\r\x19\x00\x83\x01d\x10@\x00d5A\x00d\x05k\x02\x90\to\xdat\x00|\x00d\r\x19\x00\x83\x01d\x12@\x00d\rA\x00d\x05k\x02}\x01|\x01\x90\to\xf0t\x00|\x00d\x04\x19\x00\x83\x01d6k\x02}\x01|\x01\x90\no\xc4t\x00|\x00d7\x19\x00\x83\x01d\x03@\x00d\x04?\x00d\x05k\x02\x90\no\xc4t\x00|\x00d7\x19\x00\x83\x01d\x06@\x00d\x07?\x00d\x08k\x02\x90\no\xc4t\x00|\x00d7\x19\x00\x83\x01d\t@\x00d\n?\x00d\x08k\x02\x90\no\xc4t\x00|\x00d7\x19\x00\x83\x01d\x0b@\x00d\x02?\x00d\x08k\x02\x90\no\xc4t\x00|\x00d7\x19\x00\x83\x01d\x0c@\x00d\r?\x00d\x08k\x02\x90\no\xc4t\x00|\x00d7\x19\x00\x83\x01d\x02@\x00d\x0e?\x00d\x08k\x02\x90\no\xc4t\x00|\x00d7\x19\x00\x83\x01d\x0e@\x00d\x08?\x00d\x05k\x02\x90\no\xc4t\x00|\x00d7\x19\x00\x83\x01d\x08@\x00d\x05?\x00d\x08k\x02}\x01t\x01|\x00\x83\x01}\x02|\x01\x90\x0bo\x04t\x00|\x00d8\x19\x00\x83\x01d\x10@\x00d-A\x00d\x05k\x02\x90\x0bo\x04t\x00|\x00d8\x19\x00\x83\x01d\x12@\x00d\x0eA\x00d\x05k\x02}\x01|\x01\x90\x0bo\x1at\x00|\x00d9\x19\x00\x83\x01d\x17k\x02}\x01|\x00d\x00d\n\x85\x02\x19\x00d\x1dk\x03\x90\x0br4d\x1eg\x01S\x00|\x01\x90\x0co\x06t\x00|\x00d\x12\x19\x00\x83\x01d\x03@\x00d\x04?\x00d\x05k\x02\x90\x0co\x06t\x00|\x00d\x12\x19\x00\x83\x01d\x06@\x00d\x07?\x00d\x08k\x02\x90\x0co\x06t\x00|\x00d\x12\x19\x00\x83\x01d\t@\x00d\n?\x00d\x08k\x02\x90\x0co\x06t\x00|\x00d\x12\x19\x00\x83\x01d\x0b@\x00d\x02?\x00d\x08k\x02\x90\x0co\x06t\x00|\x00d\x12\x19\x00\x83\x01d\x0c@\x00d\r?\x00d\x05k\x02\x90\x0co\x06t\x00|\x00d\x12\x19\x00\x83\x01d\x02@\x00d\x0e?\x00d\x05k\x02\x90\x0co\x06t\x00|\x00d\x12\x19\x00\x83\x01d\x0e@\x00d\x08?\x00d\x05k\x02\x90\x0co\x06t\x00|\x00d\x12\x19\x00\x83\x01d\x08@\x00d\x05?\x00d\x08k\x02}\x01|\x01\x90\x0co\xdat\x00|\x00d\x07\x19\x00\x83\x01d\x03@\x00d\x04?\x00d\x05k\x02\x90\x0co\xdat\x00|\x00d\x07\x19\x00\x83\x01d\x06@\x00d\x07?\x00d\x08k\x02\x90\x0co\xdat\x00|\x00d\x07\x19\x00\x83\x01d\t@\x00d\n?\x00d\x08k\x02\x90\x0co\xdat\x00|\x00d\x07\x19\x00\x83\x01d\x0b@\x00d\x02?\x00d\x05k\x02\x90\x0co\xdat\x00|\x00d\x07\x19\x00\x83\x01d\x0c@\x00d\r?\x00d\x05k\x02\x90\x0co\xdat\x00|\x00d\x07\x19\x00\x83\x01d\x02@\x00d\x0e?\x00d\x05k\x02\x90\x0co\xdat\x00|\x00d\x07\x19\x00\x83\x01d\x0e@\x00d\x08?\x00d\x08k\x02\x90\x0co\xdat\x00|\x00d\x07\x19\x00\x83\x01d\x08@\x00d\x05?\x00d\x08k\x02}\x01|\x01\x90\x0co\xf0t\x00|\x00d:\x19\x00\x83\x01d;k\x02}\x01|\x01\x90\ro\xc4t\x00|\x00d\x0b\x19\x00\x83\x01d\x03@\x00d\x04?\x00d\x05k\x02\x90\ro\xc4t\x00|\x00d\x0b\x19\x00\x83\x01d\x06@\x00d\x07?\x00d\x08k\x02\x90\ro\xc4t\x00|\x00d\x0b\x19\x00\x83\x01d\t@\x00d\n?\x00d\x08k\x02\x90\ro\xc4t\x00|\x00d\x0b\x19\x00\x83\x01d\x0b@\x00d\x02?\x00d\x08k\x02\x90\ro\xc4t\x00|\x00d\x0b\x19\x00\x83\x01d\x0c@\x00d\r?\x00d\x05k\x02\x90\ro\xc4t\x00|\x00d\x0b\x19\x00\x83\x01d\x02@\x00d\x0e?\x00d\x08k\x02\x90\ro\xc4t\x00|\x00d\x0b\x19\x00\x83\x01d\x0e@\x00d\x08?\x00d\x05k\x02\x90\ro\xc4t\x00|\x00d\x0b\x19\x00\x83\x01d\x08@\x00d\x05?\x00d\x08k\x02}\x01|\x01\x90\ro\xfct\x00|\x00d&lt;\x19\x00\x83\x01d\x10@\x00d5A\x00d\x05k\x02\x90\ro\xfct\x00|\x00d&lt;\x19\x00\x83\x01d\x12@\x00d\x12A\x00d\x05k\x02}\x01|\x01\x90\x0eo\xd0t\x00|\x00d=\x19\x00\x83\x01d\x03@\x00d\x04?\x00d\x05k\x02\x90\x0eo\xd0t\x00|\x00d=\x19\x00\x83\x01d\x06@\x00d\x07?\x00d\x08k\x02\x90\x0eo\xd0t\x00|\x00d=\x19\x00\x83\x01d\t@\x00d\n?\x00d\x08k\x02\x90\x0eo\xd0t\x00|\x00d=\x19\x00\x83\x01d\x0b@\x00d\x02?\x00d\x08k\x02\x90\x0eo\xd0t\x00|\x00d=\x19\x00\x83\x01d\x0c@\x00d\r?\x00d\x05k\x02\x90\x0eo\xd0t\x00|\x00d=\x19\x00\x83\x01d\x02@\x00d\x0e?\x00d\x08k\x02\x90\x0eo\xd0t\x00|\x00d=\x19\x00\x83\x01d\x0e@\x00d\x08?\x00d\x05k\x02\x90\x0eo\xd0t\x00|\x00d=\x19\x00\x83\x01d\x08@\x00d\x05?\x00d\x05k\x02}\x01t\x02\xa0\x02|\x00\xa1\x01\x01\x00t\x00|\x00d\x05\x19\x00\x83\x01d\x10@\x00d*k\x02\x90\x0er\xf8d2}\x02n\x04d&gt;}\x02|\x01\x90\x0fo\xcet\x00|\x00d&gt;\x19\x00\x83\x01d\x03@\x00d\x04?\x00d\x05k\x02\x90\x0fo\xcet\x00|\x00d&gt;\x19\x00\x83\x01d\x06@\x00d\x07?\x00d\x05k\x02\x90\x0fo\xcet\x00|\x00d&gt;\x19\x00\x83\x01d\t@\x00d\n?\x00d\x08k\x02\x90\x0fo\xcet\x00|\x00d&gt;\x19\x00\x83\x01d\x0b@\x00d\x02?\x00d\x08k\x02\x90\x0fo\xcet\x00|\x00d&gt;\x19\x00\x83\x01d\x0c@\x00d\r?\x00d\x05k\x02\x90\x0fo\xcet\x00|\x00d&gt;\x19\x00\x83\x01d\x02@\x00d\x0e?\x00d\x05k\x02\x90\x0fo\xcet\x00|\x00d&gt;\x19\x00\x83\x01d\x0e@\x00d\x08?\x00d\x08k\x02\x90\x0fo\xcet\x00|\x00d&gt;\x19\x00\x83\x01d\x08@\x00d\x05?\x00d\x08k\x02}\x01|\x01\x90\x0fo\xe4t\x00|\x00d?\x19\x00\x83\x01d@k\x02}\x01|\x01\x90\x0fo\xfat\x00|\x00d\n\x19\x00\x83\x01dAk\x02}\x01|\x01\x90\x10o\x10t\x00|\x00dB\x19\x00\x83\x01dCk\x02}\x01t\x02\xa0\x02|\x00\xa1\x01\x01\x00|\x01\x90\x10o0t\x00|\x00d3\x19\x00\x83\x01dDk\x02}\x01dE}\x02|\x01\x90\x10oJt\x00|\x00d\&#39;\x19\x00\x83\x01d k\x02}\x01|\x01\x90\x11o\x1et\x00|\x00d)\x19\x00\x83\x01d\x03@\x00d\x04?\x00d\x05k\x02\x90\x11o\x1et\x00|\x00d)\x19\x00\x83\x01d\x06@\x00d\x07?\x00d\x05k\x02\x90\x11o\x1et\x00|\x00d)\x19\x00\x83\x01d\t@\x00d\n?\x00d\x08k\x02\x90\x11o\x1et\x00|\x00d)\x19\x00\x83\x01d\x0b@\x00d\x02?\x00d\x08k\x02\x90\x11o\x1et\x00|\x00d)\x19\x00\x83\x01d\x0c@\x00d\r?\x00d\x05k\x02\x90\x11o\x1et\x00|\x00d)\x19\x00\x83\x01d\x02@\x00d\x0e?\x00d\x05k\x02\x90\x11o\x1et\x00|\x00d)\x19\x00\x83\x01d\x0e@\x00d\x08?\x00d\x08k\x02\x90\x11o\x1et\x00|\x00d)\x19\x00\x83\x01d\x08@\x00d\x05?\x00d\x08k\x02}\x01|\x01\x90\x11o4t\x00|\x00dE\x19\x00\x83\x01d\x19k\x02}\x01|\x01g\x01}\x01t\x03|\x00\x83\x01|\x01\x17\x00}\x01|\x01S\x00\x94(N\x88K\x04K\x80K\x07K\x00K@K\x06K\x01K K\x05K\x10K\x08K\x03K\x02K!K\xf0K`K\x0fK\x0cKrK\x18K\x11K3K\rKwK\x0eK\tK#\x8c\x05UMASS\x94\x89K\x13KcK&amp;KAK\x15K\x0bK\&#39;KdK%K*K$K&quot;KyK\x1dKpK\x14Kt\x8c\x01L\x94KUK\x1eK\x17K?KPK0K)K\x1fK\x19K\x1aK_K\x12K\x16K(K\x1cKaK{K\nKsKiK\x1bt\x94(\x8c\x03ord\x94\x8c\x03len\x94\x8c\x04copy\x94\x8c\x14LXNQKJIZEUZPFAQFDWIY\x94t\x94(\x8c\nEPGRFNWEUW\x94\x8c\nCYDTCHDYJM\x94\x8c\nWJLLYDLVQX\x94\x8c\nECIOZNQGST\x94t\x94\x8c\x0e&lt;OwOwhatsthis&gt;\x94\x8c\x14AZEOCEVBKZRBNUDWIWUS\x94J\xa2\xee\x81\x02C\x84\x00\x01\x04\x01\xc4\x014\x01\x16\x01\xd4\x01\x16\x01\xd4\x01\xd4\x01\x16\x018\x01\xd4\x01\x12\x01\x06\x01\x16\x01\xd4\x01\x16\x01\xd4\x018\x01\x16\x01\x16\x01\x06\x02\x04\x01\x16\x018\x01\x16\x01\xd4\x01\xd4\x01\x14\x01\x16\x01\x12\x01\x06\x01\x16\x01\x16\x01\x06\x02\x04\x018\x01\x16\x01\xd4\x01\x08\x018\x01\x16\x01\x12\x01\x06\x01\xd4\x01\xd4\x01\x16\x01\xd4\x018\x01\xd4\x01\n\x01\x16\x01\x06\x02\x04\x01\xd4\x01\x16\x01\x16\x01\x16\x01\n\x01\x16\x01\x04\x01\x16\x01\xd4\x01\x16\x01\x06\x01\x0c\x01\x94))e.&#39;)
                4042 CALL_METHOD              1
                4044 CALL_FUNCTION_EX         0
                4046 LOAD_GLOBAL              7 (globals)
                4048 CALL_FUNCTION            0
                4050 CALL_METHOD              2
                4052 STORE_FAST               3 (RWNMTPXTXX)

42069718        4054 LOAD_FAST                3 (RWNMTPXTXX)
                4056 LOAD_FAST                0 (QFBKDVBLQX)
                4058 CALL_FUNCTION            1
                4060 LOAD_FAST                1 (OVXPEYYWSK)
                4062 BINARY_ADD
                4064 STORE_FAST               1 (OVXPEYYWSK)

42069719        4066 LOAD_FAST                1 (OVXPEYYWSK)
                4068 RETURN_VALUE</code></pre>
<p>Translate them block by block, here is the positional values of the key according to the opcodes.</p>
<pre><code>s = [0]*128
s[:5] = &#39;UMASS&#39;
s[5] = 123
s[6] = 112|4
s[7] = 96|8
s[8] = 51
s[9] = 80|15
s[10] = ((1&lt;&lt;6)&amp;64)|((1&lt;&lt;5)&amp;32)|((1&lt;&lt;4)&amp;16)|((1&lt;&lt;1)&amp;2)|((1&lt;&lt;0)&amp;1)
s[11] = ((1&lt;&lt;6)&amp;64)|((1&lt;&lt;5)&amp;32)|((1&lt;&lt;4)&amp;16)
s[12] = ((1&lt;&lt;6)&amp;64)|((1&lt;&lt;5)&amp;32)|((1&lt;&lt;3)&amp;8)|((1&lt;&lt;0)&amp;1)
s[13] = ((1&lt;&lt;5)&amp;32)|((1&lt;&lt;4)&amp;16)|((1&lt;&lt;0)&amp;1)
s[14] = 49
s[15] = ((1&lt;&lt;6)&amp;64)|((1&lt;&lt;5)&amp;32)|((1&lt;&lt;0)&amp;1)
s[16] = ((1&lt;&lt;6)&amp;64)|((1&lt;&lt;5)&amp;32)|((1&lt;&lt;2)&amp;4)|((1&lt;&lt;1)&amp;2)|((1&lt;&lt;0)&amp;1)
s[17] = ((1&lt;&lt;5)&amp;32)|((1&lt;&lt;4)&amp;16)|((1&lt;&lt;1)&amp;2)|((1&lt;&lt;0)&amp;1)
s[18] = 80|15
s[19] = 98
s[20] = 112|9
s[21] = 116
s[22] = 48|3
s[23] = ((1&lt;&lt;6)&amp;64)|((1&lt;&lt;5)&amp;32)|((1&lt;&lt;1)&amp;2)|((1&lt;&lt;0)&amp;1)
s[24] = 48
s[25] = 100
s[26] = 51
s[27] = 95
s[28] = ((1&lt;&lt;6)&amp;64)|((1&lt;&lt;5)&amp;32)|((1&lt;&lt;1)&amp;2)|((1&lt;&lt;0)&amp;1)
s[29] = 112|4
s[30] = 96|6
s[31] = 116
s[32] = 96|9
s[33] = 109
s[34] = 51
s[35] = 95
s[36] = 104
s[37] = 97
s[38] = ((1&lt;&lt;6)&amp;64)|((1&lt;&lt;5)&amp;32)|((1&lt;&lt;1)&amp;2)|((1&lt;&lt;0)&amp;1)
s[39] = 96|11
s[40] = ((1&lt;&lt;6)&amp;64)|((1&lt;&lt;5)&amp;32)|((1&lt;&lt;4)&amp;16)|((1&lt;&lt;3)&amp;8)|((1&lt;&lt;2)&amp;4)|((1&lt;&lt;0)&amp;1)
print(&#39;&#39;.join(s[:5])+&#39;&#39;.join(map(chr, s[5:])))</code></pre>
<p>Run the script and feed the output to <code>babushka</code> we get a <code>yes!</code>, which means this the flag.</p>
<pre><code>$ python3 key.py|python3 babushka.py
Yes!</code></pre>
    </div>
    <a id="back-to-top" class="back-to-top" href="#header">TOP</a>
</body>
</html>
