<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>The Simpsons</title>
  <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style>
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #232629;
    color: #7a7c7d;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #7a7c7d;  padding-left: 4px; }
div.sourceCode
  { color: #cfcfc2; background-color: #232629; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span. { color: #cfcfc2; } /* Normal */
code span.al { color: #95da4c; background-color: #4d1f24; font-weight: bold; } /* Alert */
code span.an { color: #3f8058; } /* Annotation */
code span.at { color: #2980b9; } /* Attribute */
code span.bn { color: #f67400; } /* BaseN */
code span.bu { color: #7f8c8d; } /* BuiltIn */
code span.cf { color: #fdbc4b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #3daee9; } /* Char */
code span.cn { color: #27aeae; font-weight: bold; } /* Constant */
code span.co { color: #7a7c7d; } /* Comment */
code span.cv { color: #7f8c8d; } /* CommentVar */
code span.do { color: #a43340; } /* Documentation */
code span.dt { color: #2980b9; } /* DataType */
code span.dv { color: #f67400; } /* DecVal */
code span.er { color: #da4453; text-decoration: underline; } /* Error */
code span.ex { color: #0099ff; font-weight: bold; } /* Extension */
code span.fl { color: #f67400; } /* Float */
code span.fu { color: #8e44ad; } /* Function */
code span.im { color: #27ae60; } /* Import */
code span.in { color: #c45b00; } /* Information */
code span.kw { color: #cfcfc2; font-weight: bold; } /* Keyword */
code span.op { color: #cfcfc2; } /* Operator */
code span.ot { color: #27ae60; } /* Other */
code span.pp { color: #27ae60; } /* Preprocessor */
code span.re { color: #2980b9; background-color: #153042; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #da4453; } /* SpecialString */
code span.st { color: #f44f4f; } /* String */
code span.va { color: #27aeae; } /* Variable */
code span.vs { color: #da4453; } /* VerbatimString */
code span.wa { color: #da4453; } /* Warning */
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
      <meta charset="UTF-8">
      <meta name=”robots” content="index, follow">
      <meta name="description" content="CTF Writeups, hacking techniques, reverse engineering & binary exploit, etc.">
      <title>Onealmond</title>
      <link rel="stylesheet" type="text/css" href="../../css/global.css"></link>
      <script type="text/javascript" src="../../js/common.js"></script>
</head>
<body>
    <div id="header"><a class="header" href="../../index.html">[]|\|[-/-\|_/\/\[]|\||)</a></div>
    <div id="content" class="content" style="width:70%;height:auto">
<header id="title-block-header">
<h1 class="title">The Simpsons</h1>
</header>
<p>At the end of the given image there is the following piece of code.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1"></a>$ <span class="fu">strings</span> 840828909.jpg <span class="kw">|</span><span class="fu">tail</span> -5</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="ex">Ahh</span>! Realistically the Simpsons would use octal instead of decimal!</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="ex">encoded</span> = 152 162 152 145 162 167 150 172 153 162 145 170 141 162</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="ex">key</span> = chr(SolutionToDis(110 157 167 040 155 165 143 150 040 144 151 144 040 115 141 147 147 151 145 040 157 162 151 147 151 156 141 154 154 171 040 143 157 163 164 077 040 050 104 151 166 151 144 145 144 040 142 171 040 070 054 040 164 157 040 164 150 145 040 156 145 141 162 145 163 164 040 151 156 164 145 147 145 162 054 040 141 156 144 040 164 150 145 156 040 160 154 165 163 040 146 157 165 162 051))</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="ex">key</span> = key + key + chr(ord(key)<span class="ex">-4</span>)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="ex">print</span>(DecodeDat(key=key,text=encoded))</span></code></pre></div>
<p>According to the hints of finger number, the encoded text and key are octal. Decoded the key it says</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1"></a><span class="ex">How</span> much did Maggie originally cost? (Divided by 8, to the nearest integer, and then plus four)</span></code></pre></div>
<p>Searched around, I found this <a href="https://screenrant.com/simpsons-opening-credits-maggie-cash-register-money-change-reason/">post</a>.</p>
<blockquote>
<p>“In the original opening sequence, Maggie is rung up at a price of $847.63. This number wasn’t a random one, and was actually the monthly cost of raising a child back in 1989 – a subtle and clever detail.”</p>
</blockquote>
<p>The original cost is <em>847.63</em>, so according to the code snippet the key is <em>nnj</em>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a>key <span class="op">=</span> <span class="bu">round</span>(<span class="fl">847.63</span><span class="op">/</span><span class="dv">8</span>)<span class="op">+</span><span class="dv">4</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>key <span class="op">=</span> <span class="bu">chr</span>(key)</span>
<span id="cb3-3"><a href="#cb3-3"></a>key <span class="op">=</span> key <span class="op">+</span> key <span class="op">+</span> <span class="bu">chr</span>(<span class="bu">ord</span>(key)<span class="op">-</span><span class="dv">4</span>)</span></code></pre></div>
<p>Decrypted cipher text with <em>Vigenère Cipher</em> got the kernel of flag, wrapping it with <em>CTFlearn{}</em> is the flag <em>CTFlearn{wearenumberone}</em>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a>cipher <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="kw">lambda</span> x: <span class="bu">int</span>(x, <span class="dv">8</span>), encoded.split()))</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(cipher)):</span>
<span id="cb4-3"><a href="#cb4-3"></a>    a <span class="op">=</span> <span class="bu">chr</span>(<span class="bu">ord</span>(<span class="st">&#39;a&#39;</span>)<span class="op">+</span>(cipher[i]<span class="op">-</span><span class="bu">ord</span>(key[i <span class="op">%</span> <span class="bu">len</span>(key)])<span class="op">+</span><span class="dv">26</span>) <span class="op">%</span> <span class="dv">26</span>)</span>
<span id="cb4-4"><a href="#cb4-4"></a>    <span class="bu">print</span>(a, end<span class="op">=</span><span class="st">&#39;&#39;</span>)</span></code></pre></div>
    </div>
    <a id="back-to-top" class="back-to-top" href="#header">TOP</a>
</body>
</html>
